<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤ | ‡§Ø‡•Ç‡§ú‡§∞ ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§î‡§∞ ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏</title>
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; margin: 0; padding: 20px; }
        .container { background-color: #ffffff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); width: 100%; max-width: 900px; display: flex; flex-wrap: wrap; }
        
        /* Login Form Styling */
        #login-form-container { width: 100%; }
        h2 { text-align: center; color: #1877f2; margin-bottom: 25px; }
        input[type="email"], input[type="password"], button, #search-input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 16px; }
        button { background-color: #1877f2; color: white; border: none; cursor: pointer; transition: background-color 0.3s; }
        button:hover { background-color: #166fe5; }
        #error-message { color: red; text-align: center; margin-bottom: 15px; font-weight: bold; }

        /* Admin Panel Layout */
        #admin-panel { display: none; width: 100%; }
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #f0f2f5; padding-bottom: 10px; }
        .main-content { display: flex; flex-wrap: nowrap; gap: 20px; }
        
        /* Search Section */
        #search-section { padding-bottom: 15px; border-bottom: 1px solid #ddd; }
        #search-controls { display: flex; gap: 10px; }
        #search-input { margin: 0; }
        #search-button { width: 150px; }

        /* User List Section */
        #user-list-section { flex: 1; min-width: 250px; background-color: #f7f7f7; padding: 15px; border-radius: 8px; max-height: 70vh; overflow-y: auto; }
        #user-list h3 { margin-top: 0; color: #444; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .user-item { padding: 10px 15px; margin-bottom: 5px; background-color: #fff; border-radius: 5px; border-left: 5px solid #1877f2; cursor: pointer; transition: background-color 0.2s, transform 0.1s; }
        .user-item:hover { background-color: #e9ebee; transform: scale(1.02); }
        .user-item.selected { background-color: #d1e7ff; border-left: 5px solid #166fe5; font-weight: bold; }
        
        /* User Details Section */
        #user-details-section { flex: 2; background-color: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); }
        #user-details-section h3 { color: #1877f2; }
        #details-output { background-color: #fff; padding: 5px; border-radius: 6px; font-size: 14px; }
        .loading-text { text-align: center; color: #888; margin-top: 50px; }
        
        #details-output ul { list-style: none; padding: 0; margin: 5px 0 15px 0; }
        #details-output ul li { padding: 5px 0; border-bottom: 1px dotted #eee; }
        
    </style>
</head>
<body>
    <div class="container">
        <div id="login-form-container">
            <h2>‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§® üîë</h2>
            <div id="error-message"></div>
            <input type="email" id="admin-email" placeholder="‡§à‡§Æ‡•á‡§≤ (Admin Email)" required>
            <input type="password" id="admin-password" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° (Admin Password)" required>
            <button onclick="loginAdmin()">‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç</button>
        </div>

        <div id="admin-panel">
            <div class="panel-header">
                <h2>‡§è‡§°‡§Æ‡§ø‡§® ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</h2>
                <button onclick="logoutAdmin()" style="width: auto; padding: 8px 15px; background-color: #d9534f;">‡§≤‡•â‡§ó‡§Ü‡§â‡§ü</button>
            </div>

            <div class="main-content">
                <div id="user-list-section">
                    <h3>‡§Ø‡•Ç‡§ú‡§∞‡•ç‡§∏ ‡§ï‡•Ä ‡§≤‡§ø‡§∏‡•ç‡§ü</h3>
                    
                    <div id="search-section">
                        <div id="search-controls">
                            <input type="text" id="search-input" placeholder="UID ‡§Ø‡§æ ‡§à‡§Æ‡•á‡§≤ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç" style="flex: 1;">
                            <button id="search-button" onclick="searchUsers()">‡§∏‡§∞‡•ç‡§ö</button>
                        </div>
                        <p id="search-info" style="font-size: 12px; color: #555; margin-top: 5px;">‡§∏‡§≠‡•Ä ‡§Ø‡•Ç‡§ú‡§∞‡•ç‡§∏ ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§∞‡•ç‡§ö ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§ñ‡§æ‡§≤‡•Ä ‡§õ‡•ã‡§°‡§º ‡§¶‡•á‡§Ç ‡§î‡§∞ '‡§∏‡§∞‡•ç‡§ö' ‡§¶‡§¨‡§æ‡§è‡§Å‡•§</p>
                    </div>

                    <div id="user-list">
                        <p class="loading-text">‡§Ø‡•Ç‡§ú‡§∞‡•ç‡§∏ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...</p>
                    </div>
                </div>

                <div id="user-details-section">
                    <h3>‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏</h3>
                    <div id="details-output">‡§ï‡§ø‡§∏‡•Ä ‡§Ø‡•Ç‡§ú‡§∞ ‡§ï‡•ã ‡§ö‡•Å‡§®‡§®‡•á ‡§™‡§∞ ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏ ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡•á‡§Ç‡§ó‡•Ä‡•§</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

    <script>
        // *******************************************************************
        // !!! STEP 1: FIREBASE CONFIGURATION - ‡§á‡§∏‡•á ‡§Ö‡§™‡§®‡•Ä ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏ ‡§∏‡•á ‡§¨‡§¶‡§≤‡•á‡§Ç !!!
        // *******************************************************************
        const firebaseConfig = {
            // üö® ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§Ø‡•á ‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç ‡§∏‡§π‡•Ä ‡§π‡•à‡§Ç

            apiKey: "AIzaSyCZ5P2t5xRhy5d0IXV6UWcvbkUWXqyPENA",
            authDomain: "smbrand-4543a.firebaseapp.com",
            databaseURL: "https://smbrand-4543a-default-rtdb.firebaseio.com",
            projectId: "smbrand-4543a",
            storageBucket: "smbrand-4543a.firebasestorage.app",
            messagingSenderId: "720775550032",
            appId: "1:720775550032:web:0622548a007597778bad55",
            measurementId: "G-3LS5W6F8QW"
        };

        // Firebase ‡§ï‡•ã ‡§á‡§®‡§ø‡§∂‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º (Initialize) ‡§ï‡§∞‡•á‡§Ç
        firebase.initializeApp(firebaseConfig);

        // Firebase ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§á‡§Ç‡§∏‡•ç‡§ü‡•á‡§Ç‡§∏
        const auth = firebase.auth();
        const db = firebase.database(); 

        // UI Elements
        const loginFormContainer = document.getElementById('login-form-container');
        const adminPanel = document.getElementById('admin-panel');
        const errorMessage = document.getElementById('error-message');
        const userListContainer = document.getElementById('user-list');
        const detailsOutput = document.getElementById('details-output');
        const searchInput = document.getElementById('search-input'); // ‡§®‡§Ø‡§æ ‡§á‡§®‡§™‡•Å‡§ü

        let allUserData = {}; // ‡§∏‡§≠‡•Ä ‡§Ø‡•Ç‡§ú‡§∞‡•ç‡§∏ ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü

        // *******************************************************************
        // STEP 2: AUTHENTICATION FUNCTIONS 
        // *******************************************************************

        function loginAdmin() {
            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            errorMessage.textContent = ''; 
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    db.ref('ADMIN_CONTROL_LISTS/adminEmail').once('value')
                        .then((snapshot) => {
                            const dbAdminEmail = snapshot.val();
                            
                            if (dbAdminEmail && dbAdminEmail === email) {
                                console.log(`SUCCESS: Admin email check passed! Logging in as: ${email}`);
                                // onAuthStateChanged, searchUsers() ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§ó‡§æ
                            } else {
                                errorMessage.textContent = `‡§≤‡•â‡§ó‡§ø‡§® ‡§Ö‡§∏‡§´‡§≤: ‡§è‡§°‡§Æ‡§ø‡§® ‡§à‡§Æ‡•á‡§≤ ‡§Æ‡•à‡§ö ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü‡•§`;
                                console.error(`ERROR: Login Email (${email}) does not match DB Admin Email (${dbAdminEmail}).`);
                                auth.signOut();
                            }
                        })
                        .catch((dbError) => {
                             console.error("Database check failed, proceeding with login:", dbError);
                        });
                })
                .catch((authError) => {
                    errorMessage.textContent = `‡§≤‡•â‡§ó‡§ø‡§® ‡§Ö‡§∏‡§´‡§≤: ${authError.message}`;
                    console.error("Auth Login Failed:", authError);
                });
        }
        
        function logoutAdmin() {
            auth.signOut();
        }

        // *******************************************************************
        // STEP 3: DATA SEARCHING AND FETCHING LOGIC (‡§®‡§Ø‡§æ ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§®)
        // *******************************************************************
        
        // ‡§Ø‡§π ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§∏‡§∞‡•ç‡§ö ‡§á‡§®‡§™‡•Å‡§ü ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§Ø‡•Ç‡§ú‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§´‡§º‡•á‡§ö ‡§Ø‡§æ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à
        function searchUsers() {
            const query = searchInput.value.trim();
            userListContainer.innerHTML = '<p class="loading-text">‡§∏‡§∞‡•ç‡§ö ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...</p>';
            detailsOutput.innerHTML = '‡§ï‡§ø‡§∏‡•Ä ‡§Ø‡•Ç‡§ú‡§∞ ‡§ï‡•ã ‡§ö‡•Å‡§®‡§®‡•á ‡§™‡§∞ ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏ ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡•á‡§Ç‡§ó‡•Ä‡•§'; 
            allUserData = {}; 
            
            let ref = db.ref('users');

            if (query === '') {
                // 1. ‡§Ø‡§¶‡§ø ‡§∏‡§∞‡•ç‡§ö ‡§¨‡§æ‡§∞ ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§∏‡§≠‡•Ä ‡§Ø‡•Ç‡§ú‡§∞‡•ç‡§∏ (10000 ‡§§‡§ï) ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
                ref = ref.orderByKey().limitToFirst(10000);
                console.log("Fetching all users (up to 10000)...");
            } else if (query.includes('@')) {
                // 2. ‡§Ø‡§¶‡§ø ‡§á‡§®‡§™‡•Å‡§ü ‡§Æ‡•á‡§Ç '@' ‡§π‡•à, ‡§§‡•ã ‡§à‡§Æ‡•á‡§≤ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§∞‡•ç‡§ö ‡§ï‡§∞‡•á‡§Ç
                // ‡§®‡•ã‡§ü: ‡§á‡§∏‡§ï‡•á ‡§≤‡§ø‡§è Rules ‡§Æ‡•á‡§Ç ".indexOn": ["email"] ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è
                ref = ref.orderByChild('email').equalTo(query);
                console.log(`Searching by email: ${query}`);
            } else if (query.length > 5 && query.length <= 30) { 
                // 3. ‡§Ø‡§¶‡§ø ‡§Ø‡§π ‡§è‡§ï ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ UID ‡§π‡•à, ‡§§‡•ã UID (‡§ï‡•Ä) ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§∞‡•ç‡§ö ‡§ï‡§∞‡•á‡§Ç
                ref = ref.orderByKey().equalTo(query);
                console.log(`Searching by UID: ${query}`);
            } else {
                 // 4. ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä
                userListContainer.innerHTML = `<p class="loading-text" style="color: orange;">‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§∏‡§∞‡•ç‡§ö ‡§á‡§®‡§™‡•Å‡§ü‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Ç‡§∞‡•Ä UID ‡§Ø‡§æ ‡§à‡§Æ‡•á‡§≤ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§</p>`;
                return;
            }

            ref.once('value')
                .then((snapshot) => {
                    console.log("Total records fetched:", snapshot.numChildren());

                    if (snapshot.exists()) {
                        allUserData = snapshot.val();
                        displayUserList(allUserData);
                    } else {
                        userListContainer.innerHTML = '<p class="loading-text" style="color: blue;">‡§ï‡•ã‡§à ‡§Ø‡•Ç‡§ú‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§</p>';
                    }
                })
                .catch((error) => {
                    console.error("Error fetching users:", error);
                    userListContainer.innerHTML = `<p class="loading-text" style="color: red;">
                    ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§ ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}</p>`;
                });
        }

        // ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§°‡•á‡§ü‡§æ ‡§∏‡•á ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§°‡§ø‡§∏‡•ç‡§™‡•ç‡§≤‡•á ‡§ï‡§∞‡•á‡§Ç
        function displayUserList(users) {
            userListContainer.innerHTML = ''; 
            
            if (typeof users !== 'object' || users === null) {
                userListContainer.innerHTML = '<p class="loading-text" style="color: red;">‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§°‡•á‡§ü‡§æ ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ‡•§</p>';
                return;
            }

            // ‡§Ø‡§¶‡§ø ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§π‡•à (‡§ú‡•à‡§∏‡•á UID ‡§Ø‡§æ ‡§à‡§Æ‡•á‡§≤ ‡§∏‡§∞‡•ç‡§ö ‡§∏‡•á), ‡§§‡•ã ‡§á‡§∏‡•á ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•á‡§Ç
            const userKeys = Object.keys(users);
            if (userKeys.length === 1 && typeof users[userKeys[0]] !== 'object') {
                 // ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ ‡§§‡§¨ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§¨ ‡§à‡§Æ‡•á‡§≤ ‡§∏‡§∞‡•ç‡§ö ‡§è‡§ï ‡§π‡•Ä ‡§Ø‡•Ç‡•õ‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§á‡§∏‡•á ‡§†‡•Ä‡§ï ‡§∏‡•á ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§≤‡•á‡§Ç
            }


            for (const userId in users) {
                if (Object.hasOwnProperty.call(users, userId)) {
                    const userData = users[userId];
                    
                    const displayTitle = userData.name || userData.email || userData.mobile || `User ID: ${userId}`;
                    
                    const listItem = document.createElement('div');
                    listItem.classList.add('user-item');
                    listItem.textContent = displayTitle;
                    listItem.dataset.userId = userId; 
                    
                    listItem.onclick = () => showUserDetails(userId);
                    
                    userListContainer.appendChild(listItem);
                }
            }
        }
        
        // ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§Ø‡•Ç‡§ú‡§∞ ‡§ï‡•Ä ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏ ‡§°‡§ø‡§∏‡•ç‡§™‡•ç‡§≤‡•á ‡§ï‡§∞‡•á‡§Ç (‡§∞‡•Ä‡§°‡•á‡§¨‡§≤ ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü)
        function showUserDetails(userId) {
            // Selection State Update
            document.querySelectorAll('.user-item').forEach(item => {
                item.classList.remove('selected');
            });

            const currentItem = document.querySelector(`.user-item[data-user-id="${userId}"]`);
            if (currentItem) {
                currentItem.classList.add('selected');
            }
            
            const userData = allUserData[userId];
            
            if (userData) {
                // 1. ‡§∞‡•Ä‡§°‡•á‡§¨‡§≤ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏
                let readableDetails = `
                    <h4>‚úÖ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏</h4>
                    <ul>
                        <li><strong>‡§Ø‡•Ç‡§ú‡§∞ ID (UID):</strong> ${userId}</li>
                        <li><strong>‡§®‡§æ‡§Æ:</strong> ${userData.name || 'N/A'}</li>
                        <li><strong>‡§à‡§Æ‡•á‡§≤:</strong> ${userData.email || 'N/A'}</li>
                        <li><strong>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤:</strong> ${userData.mobile || 'N/A'}</li>
                        <li><strong>‡§è‡§ï‡•ç‡§ü‡§ø‡§µ ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏:</strong> ${userData.active ? 'Active' : 'Inactive'}</li>
                    </ul>
                    <hr>
                    
                    <h4>üí∞ ‡§µ‡•â‡§≤‡•á‡§ü ‡§î‡§∞ KYC ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏</h4>
                    <ul>
                        <li><strong>‡§µ‡•â‡§≤‡•á‡§ü ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏:</strong> ${userData.wallet ? (userData.wallet.balance || 0) : '0'}</li>
                        <li><strong>KYC Step 1 (Basic Info) Completed:</strong> ${userData.step1_completed || 'No'}</li>
                        <li><strong>KYC Step 2 (Documents) Completed:</strong> ${userData.step2_completed || 'No'}</li>
                        <li><strong>KYC Step 3 (Bank/Job) Completed:</strong> ${userData.step3_completed || 'No'}</li>
                    </ul>
                    <hr>
                `;

                // 2. ‡§∏‡§≠‡•Ä RAW ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã JSON ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å
                const jsonDetails = {
                    "‡§Ø‡•Ç‡§ú‡§∞_ID": userId,
                    ...userData
                };
                
                readableDetails += `
                    <h4>RAW JSON ‡§°‡•á‡§ü‡§æ (‡§™‡•Ç‡§∞‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä, URLs ‡§∏‡§π‡§ø‡§§)</h4>
                    <pre style="background-color: #f0f0f0; padding: 10px; border-radius: 4px; overflow-x: auto; white-space: pre-wrap;">${JSON.stringify(jsonDetails, null, 2)}</pre>
                `;
                
                detailsOutput.innerHTML = readableDetails;
                
            } else {
                detailsOutput.innerHTML = `Error: User ID ${userId} not found in stored data.`;
            }
        }

        // *******************************************************************
        // STEP 4: AUTH STATE LISTENER (UI SWITCH)
        // *******************************************************************

        auth.onAuthStateChanged((user) => {
            if (user) {
                // ‡§Ø‡•Ç‡§ú‡§∞ ‡§≤‡•â‡§ó‡§ø‡§® ‡§π‡•à
                loginFormContainer.style.display = 'none';
                adminPanel.style.display = 'block';
                errorMessage.textContent = '';
                searchUsers(); // ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§Ö‡§¨ ‡§∏‡§∞‡•ç‡§ö ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç (‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡§≠‡•Ä ‡§Ø‡•Ç‡§ú‡§∞‡•ç‡§∏ ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§ó‡§æ)
            } else {
                // ‡§Ø‡•Ç‡§ú‡§∞ ‡§≤‡•â‡§ó‡§Ü‡§â‡§ü ‡§π‡•à
                loginFormContainer.style.display = 'block';
                adminPanel.style.display = 'none';
                userListContainer.innerHTML = '';
                detailsOutput.innerHTML = '‡§ï‡§ø‡§∏‡•Ä ‡§Ø‡•Ç‡§ú‡§∞ ‡§ï‡•ã ‡§ö‡•Å‡§®‡§®‡•á ‡§™‡§∞ ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏ ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡•á‡§Ç‡§ó‡•Ä‡•§';
            }
        });

    </script>
</body>
</html>

